select trim(av.new_vendor_name) from dbo_sales_order s, dbo_activity a, dbo_acty_from_to aft, dbo_ckt_loc cl, dbo_ethernet_pvc epvc, dbo_ethernet_port eport, dbo_logical_ip l, dbo_access_vendor av where s.sales_order_name = 'IP21017929' and s.valid_ind = 'Y' and s.sales_order_id = a.so_id and a.ntwk_entity_type = 18 and a.action not in(0) and a.activity_id = aft.activity_id and aft.to_key = epvc.ethernet_pvc_id and epvc.buf_ethernet_port_id = eport.ethernet_port_id and eport.buf_log_ip_id = l.log_ip_id and l.circuit_id = cl.circuit_id and cl.cust_spec_access_vend = av.access_vendor_id and a.uso_number={UsoNumber} UNION ALL select trim(av.new_vendor_name) from dbo_sales_order s, dbo_activity a, dbo_ckt_loc cl, dbo_ethernet_pvc epvc, dbo_ethernet_port eport, dbo_logical_ip l, dbo_access_vendor av where s.sales_order_name = 'IP21017929' and s.valid_ind = 'Y' and s.sales_order_id = a.so_id and a.ntwk_entity_type = 18 and a.action = 0 and a.ntwk_entity_id = epvc.ethernet_pvc_id and epvc.buf_ethernet_port_id = eport.ethernet_port_id and eport.buf_log_ip_id = l.log_ip_id and l.circuit_id = cl.circuit_id and cl.cust_spec_access_vend = av.access_vendor_id and a.uso_number={UsoNumber} union select trim(av.new_vendor_name) from dbo_sales_order s, dbo_activity a, dbo_ckt_loc cl, dbo_access_vendor av where s.sales_order_name = 'IP21017929' and s.valid_ind = 'Y' and s.sales_order_id = a.so_id and a.ntwk_entity_type = 0 and a.ntwk_entity_id = cl.circuit_id and cl.cust_spec_access_vend = av.access_vendor_id and a.uso_number={UsoNumber} union SELECT trim(AV.NEW_VENDOR_NAME) FROM dbo_SALES_ORDER SO, dbo_SALES_ORDER_SUPP SOS, dbo_ACTIVITY A, dbo_CKT_LOC CL, dbo_ACCESS_VENDOR AV, dbo_LOGICAL_IP LP WHERE 1=1 AND SOS.SALES_ORDER_ID = SO.SALES_ORDER_ID AND SO.SALES_ORDER_ID = A.SO_ID AND A.NTWK_ENTITY_ID = LP.LOG_IP_ID AND LP.CIRCUIT_ID = CL.CIRCUIT_ID and A.action=0 AND CL.CKL_NO = '2' AND A.NTWK_ENTITY_TYPE = '6' AND CL.CUST_SPEC_ACCESS_VEND = AV.ACCESS_VENDOR_ID and a.uso_number={UsoNumber} UNION select trim(AV.NEW_VENDOR_NAME) from dbo_SALES_ORDER SO, dbo_SALES_ORDER_SUPP SOS, dbo_ACTIVITY A, dbo_CKT_LOC CL, dbo_ACTY_FROM_TO ATO , dbo_ACCESS_VENDOR AV, dbo_LOGICAL_IP LP where 1=1 AND SO.SALES_ORDER_ID = A.SO_ID AND A.ACTIVITY_ID = ATO.ACTIVITY_ID AND A.ACTION != 0 AND ATO.TO_KEY = LP.LOG_IP_ID AND LP.CIRCUIT_ID = CL.CIRCUIT_ID AND CL.CKL_NO IN( '2') AND A.NTWK_ENTITY_TYPE = 6 AND CL. CUST_SPEC_ACCESS_VEND = AV.ACCESS_VENDOR_ID AND A.CANCEL_IND='N' AND SOS.SALES_ORDER_ID = SO.SALES_ORDER_ID and a.uso_number={UsoNumber}
